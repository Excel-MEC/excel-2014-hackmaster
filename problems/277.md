  <p>  A modified Collatz sequence of integers is obtained from a starting value a1 in the following way:</p>  <p>  an+1 = an/3 if an is divisible by 3. We shall denote this as a large downward step, "D".</p>  <p>  an+1 = (4an + 2)/3 if an divided by 3 gives a remainder of 1. We shall denote this as an upward step, "U".  </p>  <p>  an+1 = (2an - 1)/3 if an divided by 3 gives a remainder of 2. We shall denote this as a small downward step, "d".  </p>      <p>  The sequence terminates when some an = 1.  </p>  <p>  Given any integer, we can list out the sequence of steps.<br />  For instance if a1=231, then the sequence {an}={231,77,51,17,11,7,10,14,9,3,1} corresponds to the steps "DdDddUUdDD".  </p>  <p>  Of course, there are other sequences that begin with that same sequence "DdDddUUdDD....".<br />  For instance, if a1=1004064, then the sequence is DdDddUUdDDDdUDUUUdDdUUDDDUdDD.<br />  In fact, 1004064 is the smallest possible a1 <img src='images/symbol_gt.gif' width='10' height='10' alt='&gt;' border='0' style='vertical-align:middle;' /> 106 that begins with the sequence DdDddUUdDD.  </p>  <p>  What is the smallest a1 <img src='images/symbol_gt.gif' width='10' height='10' alt='&gt;' border='0' style='vertical-align:middle;' /> 1015 that begins with the sequence "UDDDUdddDDUDDddDdDddDDUDDdUUDd"?  </p>                  